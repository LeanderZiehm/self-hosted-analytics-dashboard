<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div id="main" ></div>

    <script>

        const base_url = "https://self-hosted-analytics.vercel.app"

        function getFullURL(addPath){
            return base_url + addPath
        }


        function createTableHTML(){

            const table = document.createElement("table");
            table.id = "analytics-table";

            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");
            const headers = ["URL", "IP Address", "Browser", "OS", "Device", "Screen Size", "Language", "Time"];
            headers.forEach(headerText => {
                const th = document.createElement("th");
                th.textContent = headerText;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            table.appendChild(tbody);
        }


        function main(){
            startLoadingData()
            const mainDiv = document.getElementById("main");

            const title = document.createElement("h1");
            title.textContent = "Analytics Dashboard";
            mainDiv.appendChild(title);

            const subtitle = document.createElement("h2");
            subtitle.textContent = "Tracking Data";
            mainDiv.appendChild(subtitle);
        }


        function createTableHTML(headers){
            const table = document.createElement("table");
            table.id = "analytics-table";

            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");
            headers.forEach(headerText => {
                const th = document.createElement("th");
                th.textContent = headerText;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            table.appendChild(tbody);

            return table;

        }


        function onDataLoaded(data){

            const headers = data
            
            const table = createTableHTML

            
        }

        async function startLoadingData() {
            try {

                const url = getFullURL('/analytics');
                const response = await fetch(url);
                const data = await response.json();
                console.log("Data loaded:", data);
                onDataLoaded(data);
            } catch (error) {
                console.error("Error loading data:", error);
            }
        }



        document.addEventListener("DOMContentLoaded",main);
    </script>
</body>
</html>
